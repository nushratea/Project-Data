---
title: "Demographics vs. Income"
author: "Nushrate Ahmed"
date: "2024-10-05"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)

#Setting echo to False prevents code from printing in the report, only output shows
knitr::opts_chunk$set(echo = FALSE)
```

## Assignment Scenario

In this scenario, you will be a data scientist recently hired by a company that provides career services to those with lower incomes. The marketing team has a small budget and wants your help to find out which demographics (age, education, gender, etc) to target advertising in the US. The data originates from the census database. Your task is to create an interactive dashboard with Shiny to explore census data to figure out what trends in different demographics you can find and tell the marketing team your findings.

## Objectives

You work for a company that provides career services for lower-income people. The marketing team has a small budget and wants your help to find out which demographics (age, education, gender, etc) to target advertise to in the US. You will create an interactive dashboard with Shiny to explore census data to figure out what trends in different demographics you can find and tell the marketing team your findings. Create a dashboard with the UCI Adult dataset that can give insight on the following questions:

-   Does education level impact the salary?
-   Impact of age and sex on salary?
-   People from which native countries are given less income despite having good education?
-   Does number of hours working contribute to less income?
-   Which work-class faces less income?

Afterward, create a report using [**rmarkdown**](http://rmarkdown.rstudio.com/)
to document the steps taken and the findings.

## Dataset Used

The dataset you will use is the UCI Adult dataset. The dataset was taken from the Census database and contains demographic information on people. The variables you will focus on are:

-   native_country: the person's native country
-   age: age of person
-   hours_per_week: number of hours the person works per week
-   education: education level
-   workclass: class of work like federal government or private etc.
-   sex: male or female
-   prediction: the income level, either "\<=50K" or "\>50K", you will facet your graphs by this variable

## Tasks

First, import the CSV file containing the demographics data from either the server or computer (in this case it was from personal laptop):

```{r}
# Load dataset 
adult=import("adult.csv")
# Convert column names to lowercase for convenience 
names(adult)=tolower(names(adult))
```

Import the necessary libaries needed:

```{r}
library(shiny)
library(tidyverse)
library(rio)
library(ggthemes)
library(rsconnect)
```

Task 1: Add application title in the UI

```{r}
# Application Layout
shinyUI(fluidPage(
  br(),
  titlePanel("Trend in Demographics and Income"),
  p("Explore the difference between people who earn less than 50K and more than 50K. You can filter the data by country, then explore various demogrphic information."),
```

```{{r echo=FALSE, out.width = "30%", fig.align = "center"}}
knitr::include_graphics("https://github.com/nushratea/Project-Data/blob/main/Data%20Visualization%20Examples/R%20Language/R%20application/Task%201.png")
```

Task 2: Add first fluidRow to select input for country in UI

```{r}
  fluidRow(
    column(12, 
           wellPanel(selectInput("country","Select Country",choices=c("United-States","Canada","Mexico","Germany","Philippines")))
    )  # add select input 
  ),
```

Task 3: Add a second fluidRow to control how to plot the continuous variables in UI

```{r}
fluidRow(
    column(3, 
           wellPanel(
             p("Select a continuous variable and graph type (histogram or boxplot) to view on the right."),
             radioButtons("continuous_variable","Continuous",choices=c("age","hours_per_week")),   
             radioButtons("graph_type","Graph",choices=c("histogram","boxplot")) 
           )
    ),column(9, plotOutput("p1"))  
  ),
```

Task 4: Add third fluidRow to control how to plot the categorical variables in UI

```{r}
  fluidRow(
    column(3, 
           wellPanel(
             p("Select a categorical variable to view bar chart on the right. Use the check box to view a stacked bar chart to combine the income levels into one graph. "),
             radioButtons("categorical_variable","Category",choices=c("education","workclass","sex")), 
             checkboxInput("is_stacked","Stack Bar",value=FALSE)
           )
    ),
    column(9, plotOutput("p2"))
  )
)
)
```

Start the server.R file the same way as ui.R file.

```{r}
# Load libraries
library(shiny)
library(tidyverse)

# Read in data
adult <- read_csv("adult.csv")
# Convert column names to lowercase for convenience 
names(adult) <- tolower(names(adult))
```

Define the server logic before beginning with the logic for the graphs.

```{r}
# Define server logic
shinyServer(function(input, output) {
  
  df_country <- reactive({
    adult %>% filter(native_country == input$country)
  })
```

Task 5: Create logic to plot histogram or boxplot in server Task 5.1: Show the boxplot of the “age” variable\
Task 5.2: Show the histogram of the “hours_per_week"

```{r}
  output$p1 <- renderPlot({
    if (input$graph_type == "histogram") {
      # Histogram
      ggplot(df_country(), aes_string(x =input$continuous_variable)) +
        geom_histogram(color="black",fill="orange") +  
        labs(y="Number of People", title=paste("Trend of ",input$continuous_variable)) +  
        facet_wrap(~prediction)+ 
        theme_light()
    }
    else {
      # Boxplot
      ggplot(df_country(), aes_string(y = input$continuous_variable)) +
        geom_boxplot(color="maroon",fill="darkgoldenrod1") +  
        coord_flip() +  
        labs(x="Number of People", title=paste("Boxplot of",input$continuous_variable)) +
        facet_wrap(~prediction)+    
        theme_light()
    }
    
  })
```

Task 6: Create logic to plot a faceted bar chart or stacked bar chart in the server Task 6.1: Show the faceted unstacked bar chart for the “workclass” variable Task 6.2: Show the stacked bar chart for the “education” variable

```{r}
 output$p2 <- renderPlot({
    # Bar chart
    p <- ggplot(df_country(), aes_string(x =input$categorical_variable)) +
      labs(y="Number of People",title=(paste("Trend of",input$categorical_variable))) +  
      theme_light()+
      theme(axis.text.x=element_text(angle=45),legend.position="bottom")    
    
    
    if (input$is_stacked) {
      p + geom_bar(aes(fill=prediction))  
    }
    else{
      p + 
        geom_bar(aes_string(fill=input$categorical_variable)) + 
        facet_wrap(~prediction)  
    }
  })
  
})
```

Task 7: Share your final dashboard (including any optional changes to the themes or customizations to the graphs)

```{r}
summary(cars)
```

